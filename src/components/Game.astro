---

---

<div class="vignette">
	<div class="mx-auto flex w-2/3 flex-col justify-center gap-20">
		<p></p>
		<button class="mt-5 opacity-0" id="play-button" inert>Play</button>
	</div>
</div>

<button id="look-around">Look around</button>

<script>
	const introText =
		"You wake up slowly, feeling the cold sand and a throbbing headache.$Struggling to sit up, you take a look around...";

	const button = document.querySelector("#look-around") as HTMLButtonElement;
	const vignette = document.querySelector(".vignette") as HTMLElement;
	const p = vignette.querySelector("p") as HTMLParagraphElement;

	button.addEventListener("click", () => {
		vignette.style.display = "block";
		requestAnimationFrame(async () => {
			vignette.classList.add("vignette-enabled");

			let i = 0;
			let done = false;

			function skipIntro() {
				if (done) return;
				done = true;
				p.innerHTML = introText.replace(/\$/g, "<br><br>");
			}

			vignette.addEventListener("click", skipIntro);

			await new Promise((r) => setTimeout(r, 1250));

			// Typewriter effect
			for (const char of introText) {
				if (done) break;
				if (char === "$") {
					p.innerHTML += "<br><br>";
					await new Promise((r) => setTimeout(r, 1000));
				} else if (char === ",") {
					p.innerHTML += char;
					await new Promise((r) => setTimeout(r, 125));
				} else {
					p.innerHTML += char;
				}
				i++;
				await new Promise((r) => setTimeout(r, 55));
			}
			done = true;

			vignette.removeEventListener("click", skipIntro);

			const button = vignette.querySelector("button") as HTMLButtonElement;
			button.classList.remove("opacity-0");
			button.inert = false;
		});
	});
</script>

<style>
	.vignette {
		display: none;
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		transition:
			background-color 1000ms linear,
			box-shadow 1000ms linear;
		font-family: "Iowan Old Style", "Palatino Linotype", "URW Palladio L", P052, serif;
		font-weight: normal;
	}

	.vignette p {
		color: white;
		font-size: 1.5rem;
		margin-top: 25vh;
	}

	.vignette-enabled {
		box-shadow: 0 0 300px rgba(0, 0, 0, 0.9) inset;
		background-color: rgba(0, 0, 0, 0.95);
	}

	#play-button {
		border: none;
		margin: 0;
		padding: 0;
		width: auto;
		overflow: visible;

		background: transparent;

		/* inherit font & color from ancestor */
		color: inherit;
		font: inherit;

		/* Normalize `line-height`. Cannot be changed from `normal` in Firefox 4+. */
		line-height: normal;

		/* Corrects font smoothing for webkit */
		-webkit-font-smoothing: inherit;
		-moz-osx-font-smoothing: inherit;

		/* Corrects inability to style clickable `input` types in iOS */
		-webkit-appearance: none;

		font-size: 2.5rem;
		color: #fff;
		font-weight: bold;
		width: min-content;
		margin: 0 auto;
	}

	#play-button:hover {
		cursor: pointer;
		color: #f00;
	}
</style>
